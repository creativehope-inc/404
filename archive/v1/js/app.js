!function(i){function t(i){this.initialize(i)}var h=t.prototype=new createjs.Container;t.LRG_ROCK=60,t.SML_ROCK=25,h.bounds,h.hit,h.size,h.spin,h.score,h.vX,h.vY,h.active,h.Shape_initialize=h.initialize,h.initialize=function(i){this.Shape_initialize(),this.activate(i)},h.activate=function(i){switch(this.size=i,this.hit=i,this.bounds=0,i){case t.LRG_ROCK:this.rockFlame=new createjs.Bitmap("./img/drag_01.png"),this.rockFlame.x=-75,this.rockFlame.y=-62;break;case t.SML_ROCK:this.rockFlame=new createjs.Bitmap("./img/shooted_drag_01.png"),this.rockFlame.x=-25,this.rockFlame.y=-25}this.removeAllChildren(),this.addChild(this.rockFlame);var h=2*Math.random()*Math.PI;this.vX=Math.sin(h)*(5-i/10),this.vY=Math.cos(h)*(5-i/10),this.spin=(Math.random()+.2)*this.vX,this.score=100*(5-i/10),this.score<0&&(this.score-=this.score),this.active=!0},h.tick=function(){this.rotation+=this.spin,this.x+=this.vX,this.y+=this.vY},h.floatOnScreen=function(i,t){Math.random()*(i+t)>i?(this.x=this.vX>0?-2*this.bounds:2*this.bounds+i,this.y=this.vY>0?Math.random()*t*.5:Math.random()*t*.5+.5*t):(this.y=this.vY>0?-2*this.bounds:2*this.bounds+t,this.x=this.vX>0?Math.random()*i*.5:Math.random()*i*.5+.5*i)},h.hitPoint=function(i,t){return this.hitRadius(i,t,0)},h.hitRadius=function(i,t,h){return i-h>this.x+this.hit||i+h<this.x-this.hit||t-h>this.y+this.hit||t+h<this.y-this.hit?void 0:this.hit+h>Math.sqrt(Math.pow(Math.abs(this.x-i),2)+Math.pow(Math.abs(this.y-t),2))},i.SpaceRock=t}(window);
!function(t){function i(){this.initialize()}var h=i.prototype=new createjs.Container;i.TOGGLE=60,i.MAX_THRUST=2,i.MAX_VELOCITY=5,h.shipFlame,h.shipBody,h.timeout,h.thrust,h.vX,h.vY,h.bounds,h.hit,h.Container_initialize=h.initialize,h.initialize=function(){this.Container_initialize(),this.shipFlame=new createjs.Bitmap("./img/main.png"),this.shipFlame.x=-50,this.shipFlame.y=-44,this.addChild(this.shipFlame),this.bounds=10,this.hit=this.bounds,this.timeout=0,this.thrust=0,this.vX=0,this.vY=0},h.tick=function(){this.x+=this.vX,this.y+=this.vY,this.thrust>0?(this.timeout++,this.timeout>i.TOGGLE&&(this.timeout=0),this.thrust-=.5):this.thrust=0},h.accelerate=function(){this.thrust+=this.thrust+.6,this.thrust>=i.MAX_THRUST&&(this.thrust=i.MAX_THRUST),this.vX+=Math.sin((this.rotation+90)*(Math.PI/-180))*this.thrust,this.vY+=Math.cos((this.rotation+90)*(Math.PI/-180))*this.thrust,this.vX=Math.min(i.MAX_VELOCITY,Math.max(-i.MAX_VELOCITY,this.vX)),this.vY=Math.min(i.MAX_VELOCITY,Math.max(-i.MAX_VELOCITY,this.vY))},t.Ship=i}(window);
!function(e){function t(){M.text="ロード中 "+(100*L.progress|0)+"%",T.update()}function n(){clearInterval(Y),F=new createjs.Text("0","bold 16px Arial","#FFFFFF"),F.textAlign="right",F.maxWidth=1e3,F.x=C.width-20,F.y=20,M.text="404 Not Found Game　=> Click Start",o()}function o(){T.addChild(M),T.update(),C.onclick=a}function a(){C.onclick=null,T.removeChild(M),c()}function c(){T.removeAllChildren(),F.text=0..toString(),T.addChild(F),R=new Array,j=new Array,A=!0,N=new Ship,N.x=C.width/2,N.y=C.height/2,E=U,x=B=0,b=w=I=_=dnHeld=!1,createjs.Sound.stop(),createjs.Sound.play("begin"),createjs.Sound.play("music",createjs.Sound.INTERRUPT_NONE,0,0,-1,.4),T.clear(),T.addChild(N),createjs.Ticker.hasEventListener("tick")||createjs.Ticker.addEventListener("tick",i)}function i(e){if(0>=B?A&&b&&(B=P,d()):B--,A&&w?N.rotation-=D:A&&I&&(N.rotation+=D),A&&_&&N.accelerate(),0>=x){if(A){E-=O;var t=u(SpaceRock.LRG_ROCK);R[t].floatOnScreen(C.width,C.height),x=E+E*Math.random()}}else x--;A&&r(N,N.bounds)&&s(N,N.bounds);for(bullet in j){var n=j[bullet];n&&n.active&&(r(n,N.bounds)&&s(n,N.bounds),n.x+=Math.sin(n.rotation*(Math.PI/-180))*G,n.y+=Math.cos(n.rotation*(Math.PI/-180))*G,--n.entropy<=0&&(T.removeChild(n),n.active=!1))}for(spaceRock in R){var n=R[spaceRock];if(n&&n.active)if(r(n,n.bounds)&&s(n,n.bounds),n.tick(e),A&&n.hitRadius(N.x,N.y,N.hit)){if(n.size==SpaceRock.SML_ROCK){h(1e3),T.removeChild(n),R[spaceRock].active=!1,createjs.Sound.play("heart_get",createjs.Sound.INTERUPT_LATE);continue}A=!1,T.removeChild(N),M.text="Game over!! またゲームをするには画面をクリックしてください",T.addChild(M),o(),k(Number(F.text)),createjs.Sound.play("death",createjs.Sound.INTERRUPT_ANY)}else for(bullet in j){var a=j[bullet];if(a&&a.active&&n.hitPoint(a.x,a.y)){var c;switch(n.size){case SpaceRock.LRG_ROCK:c=SpaceRock.SML_ROCK;break;case SpaceRock.SML_ROCK:c=0}if(c>0){var t=u(c),i=Math.random()*n.size*2-n.size;R[t].x=n.x+i,R[t].y=n.y+i}T.removeChild(n),R[spaceRock].active=!1,T.removeChild(a),j[bullet].active=!1,h(100),createjs.Sound.play("break",createjs.Sound.INTERUPT_LATE,0,.8)}}}N.tick(e),T.update(e)}function r(e,t){return e.x<-2*t||e.y<-2*t||e.x>C.width+2*t||e.y>C.height+2*t}function s(e,t){e.x>C.width+2*t?e.x=-2*t:e.x<-2*t&&(e.x=C.width+2*t),e.y>C.height+2*t?e.y=-2*t:e.y<-2*t&&(e.y=C.height+2*t)}function d(){var e=j[l()];e.x=N.x,e.y=N.y,e.rotation=N.rotation+90,e.entropy=z,e.active=!0,createjs.Sound.play("laser",createjs.Sound.INTERUPT_LATE)}function u(e){for(var t=0,n=R.length;n>=t;){if(!R[t]){R[t]=new SpaceRock(e);break}if(!R[t].active){R[t].activate(e);break}t++}return 0==n&&(R[0]=new SpaceRock(e)),T.addChild(R[t]),t}function l(){for(var e=0,t=j.length;t>=e;){if(!j[e]){j[e]=new createjs.Bitmap("./img/heart_shoot.png");break}if(!j[e].active){j[e].active=!0;break}e++}return 0==t&&(j[0]=new createjs.Bitmap("./img/heart_shoot.png")),T.addChild(j[e]),e}function m(t){if(!t)var t=e.event;switch(t.keyCode){case K:return b=!0,!1;case W:return w=!0,!1;case Q:return I=!0,!1;case J:return _=!0,!1;case H:return C.onclick==a&&a(),!1}}function p(t){if(!t)var t=e.event;switch(t.keyCode){case K:b=!1;break;case W:w=!1;break;case Q:I=!1;break;case J:_=!1}}function h(e){F.text=(Number(F.text)+Number(e)).toString()}function g(e){if(e&&document.cookie)for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var o=t[n].split("=");if(o[0]==e)return unescape(o[1])}}function y(e,t,n,o,a,c){if(e){var i=e+"="+escape(t);if(n&&(1==n&&(n=location.hostname),i+="; domain="+n),o&&(1==o&&(o=location.pathname),i+="; path="+o),a){var r=(new Date).getTime();a=new Date(r+864e5*a),a=a.toGMTString(),i+="; expires="+a}c&&"https:"==location.protocol&&(i+="; secure"),document.cookie=i}}function f(){var e=g("sound"),t=document.getElementById("sound"),n=document.getElementById("switchSound");t.onclick=function(){return"on"===t.getAttribute("data-status")?(y("sound","off",1,"/",1),createjs.Sound.setMute(!0),t.setAttribute("data-status","off"),n.checked=!1,!1):(y("sound","on",1,"/",1),createjs.Sound.setMute(!1),t.setAttribute("data-status","on"),n.checked=!0,!1)},null===e||"on"===e?(createjs.Sound.setMute(!1),t.setAttribute("data-status","on"),n.checked=!0):"off"===e&&(createjs.Sound.setMute(!0),t.setAttribute("data-status","off"),n.checked=!1)}function k(t){var n=document.getElementById("overlay"),o=document.getElementById("shareScoreOverlay"),a=document.getElementById("shareScoreClose"),c=document.getElementById("nickNameInput"),i=document.getElementById("scoreInput"),r=document.getElementById("sendScoreButton"),s=document.getElementById("twitterShareButton"),d=document.getElementById("facebookShareButton"),u=document.getElementById("innerRanking"),l=document.getElementById("sendScoreForm"),m=document.getElementById("scoreText"),p=document.getElementById("rankIn"),h=document.getElementById("rankInScore");n.style.display="block",o.style.display="block",l.style.display="block",m.style.display="block",u.style.display="none",i.value=t,q||(q=!0,n.onclick=function(){n.style.display="none",o.style.display="none"},a.onclick=function(){n.style.display="none",o.style.display="none"},r.onclick=function(){var t="";try{if(!e.localStorage)throw 0;var n=e.localStorage.getItem("__pcmnz");n=JSON.parse(n),t=n.userId}catch(o){}e._picomon_savedScore=function(e){u.style.display="block",l.style.display="none",m.style.display="none",0!==e.rank&&e.rank<=10?(p.style.display="block",h.innerHTML=e.rank+"位"):p.style.display="none";for(var t in e.ranking)try{var n=JSON.parse(e.ranking[t]);+t+1>3&&(document.getElementById("innnerRankingNo_"+t).innerHTML=+t+1),document.getElementById("innnerRankingName_"+t).innerHTML=n.nickname,document.getElementById("innnerRankingScore_"+t).innerHTML=n.score}catch(o){continue}};var a="function"==typeof e.__404_picomon_solt__?__404_picomon_solt__():"",i=document.createElement("script"),r=Number(F.text);i.src="https://www.picomon.jp/game/set_score?data="+Base64.encodeURI(a+Base64.encodeURI(JSON.stringify({callback:"_picomon_savedScore",type:"first404",score:0===r?1:r,nickname:encodeURIComponent(c.value)})));var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(i,s),i.onload=function(){s.parentNode.removeChild(i)}},s.onclick=function(){var t=encodeURIComponent("ピコもん 404ゲームで"+document.getElementById("scoreInput").value+"スコアを獲得した！");e.open("https://twitter.com/intent/tweet?hashtags=picomon&original_referer=http%3A%2F%2F404.picomon.jp%2F&text="+t+"&tw_p=tweetbutton&url=http%3A%2F%2F404.picomon.jp%2F&related=picomon_jp",null,"width=400,height=300")},d.onclick=function(){var t=function(){e.open("https://www.facebook.com/sharer.php?src=bm&v=4&i=1374645413&u="+encodeURIComponent(location.href)+"&t="+encodeURIComponent("ピコもん 404ゲームで"+document.getElementById("scoreInput").value+"スコアを獲得した！"),"sharer","toolbar=0,status=0,resizable=1,width=626,height=436")};/Firefox/.test(navigator.userAgent)?setTimeout(t,0):t()})}var v=document.createElement("script");v.src="https://www.picomon.jp/game/get_solt.js";var S=document.getElementsByTagName("script")[0];S.parentNode.insertBefore(v,S);var b,w,I,_,E,x,B,R,j,C,T,N,A,M,F,L,O=4,U=110,P=5,z=100,D=7,G=17,H=13,K=32,J=38,W=37,Q=39,Y=0;document.onkeydown=m,document.onkeyup=p;var L;e.onload=function(){if(!createjs.Sound.initializeDefaultPlugins()||createjs.Sound.BrowserDetect.isIOS||createjs.Sound.BrowserDetect.isAndroid)return document.getElementById("error").style.display="block";document.getElementById("canvasShowArea").style.display="block",C=document.getElementById("gameCanvas"),T=new createjs.Stage(C),M=new createjs.Text("Not found game loading","bold 24px Arial","#FFF"),M.maxWidth=1e3,M.textAlign="center",M.x=C.width/2,M.y=C.height/2,T.addChild(M),T.update();var e=[{id:"begin",src:"./music/start.mp3|./music/start.ogg"},{id:"break",src:"./music/hit.mp3|./music/hit.ogg",data:6},{id:"heart_get",src:"./music/heart_get.mp3|./music/heart_get.ogg"},{id:"death",src:"./music/dead.mp3|./music/dead.ogg"},{id:"laser",src:"./music/shoot.mp3|./music/shoot.ogg",data:6},{id:"music",src:"./music/bgm.mp3|./music/bgm.ogg"}];L=new createjs.LoadQueue,L.installPlugin(createjs.Sound),L.addEventListener("complete",n),L.addEventListener("progress",t),L.loadManifest(e),f()};var q=!1}(window);
