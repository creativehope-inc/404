(function(e){function t(e){this.initialize(e)}var n=t.prototype=new createjs.Container;n.Container_initialize=n.initialize;n.initialize=function(e){this.itemImage=new createjs.Bitmap("./img/img_item.png");this.itemImage.x=Math.floor(Math.random()*(750-160)+160);this.itemImage.y=e;this.itemImage.width=20;this.itemImage.height=20;this.addChild(this.itemImage);return this};n.getItemPosition=function(){return{x:this.itemImage.x,y:this.itemImage.y}};n.moveItemPositionY=function(e){this.itemImage.y+=e};n.removeItem=function(){this.removeChildAt(this.itemImage)};n.isCollisionCheckItem=function(e,t){if(e+30<this.itemImage.x+this.itemImage.width&&e+90>this.itemImage.x&&t+10<this.itemImage.y+this.itemImage.height&&t+130>this.itemImage.y){return true}else{return false}};e.Item=t})(window);
(function(e){function t(e,t){this.initialize(e,t)}var n=t.prototype=new createjs.Container;n.Container_initialize=n.initialize;n.initialize=function(e,t){this.secImage=new createjs.Bitmap("./img/5sec.png");this.secImage.x=e;this.secImage.y=t;this.secImage.width=20;this.secImage.height=20;this.addChild(this.secImage);return this};n.getSecPosition=function(){return{x:this.secImage.x,y:this.secImage.y}};n.moveSecPositionY=function(e){this.secImage.y+=e};n.removeSec=function(){this.removeChildAt(this.secImage)};n.isCollisionCheckSec=function(e,t){if(e+30<this.secImage.x+this.secImage.width&&e+90>this.secImage.x&&t+10<this.secImage.y+this.secImage.height&&t+130>this.secImage.y){return true}else{return false}};e.Sec=t})(window);
(function(e){function t(e,t){this.initialize(e,t)}var n=t.prototype=new createjs.Container;var r;var i;var s=0;n.Container_initialize=n.initialize;n.initialize=function(e,t){this.Container_initialize();this.floorflameleft=160;this.floorflameright=840;this.floorflameheight=20;this.collection=[];r=[160,240,320,400,480,560,640,720];var n=0;var i=8;var o=0;var u;if(t===1){while(n<i){u=new Floor(r[n],e,1);this.collection.push(u);n++}return}while(n<i){var a=Math.floor(Math.random()*(i-1)+1);switch(a){case 1:u=new Floor(r[n],e,1);n+=1;break;case 2:if(n>6){u=new Floor(r[n],e,1);n+=1}else{u=new Floor(r[n],e,2);n+=2}break;case 3:if(n>5){u=new Floor(r[n],e,1);n+=1}else{u=new Floor(r[n],e,3);n+=3}break;default:n+=1;u=false;s++;break}if(u)this.collection.push(u)}if(s==i){while(o<i){u=new Floor(r[o],e,1);this.collection.push(u);o++}}s=0};n.getfloor=function(){return this.collection};n.isCollisionCheck=function(e,t){for(var n=0;n<this.collection.length;n++){i=this.collection[n].isCollisionCheckFloor(e,t);if(i)return i}return i};e.FloorGroup=t})(window);
(function(e){function t(e,t,n){this.initialize(e,t,n)}var n=t.prototype=new createjs.Container;n.Container_initialize=n.initialize;n.initialize=function(e,t,n){this.Container_initialize();var r,i;switch(n){case 1:i="./img/img_floor1.png";r=80;break;case 2:i="./img/img_floor2.png";r=160;break;case 3:i="./img/img_floor3.png";r=240;break;default:return}this.floorImage=new createjs.Bitmap(i);this.floorImage.x=e;this.floorImage.y=t;this.floorImage.width=r;this.addChild(this.floorImage)};n.isCollisionCheckFloor=function(e,t){if(!isSpacePush&&t+130>this.floorImage.y&&e.children[0].x+90>this.floorImage.x&&e.children[0].x+40<this.floorImage.x+this.floorImage.width){return true}return false};e.Floor=t})(window);
(function(e){function t(){this.initialize()}var n=t.prototype=new createjs.Container;var r=0;var i;var s;var o=0;var u;n.Container_initialize=n.initialize;var a;n.initialize=function(){this.Container_initialize();this.width=130;this.height=140;a=this.createAnimation();a.x=STAGE_WIDTH/2.3;a.y=STAGE_HEIGHT-200;vY=0;i=0;u=0;this.setKeyEvent(this);createjs.Ticker.setFPS(20);createjs.Ticker.addEventListener("tick",this.tick)};n.getAnimation=function(){return a};n.setFloorY=function(e){s=e+20};n.setVy=function(e){vY=e};n.getVy=function(){return vY};n.getWhere=function(){return i};n.getAnimationY=function(){return a.y};n.setCollision=function(){isStand=true};n.setNotCollision=function(){isStand=false};n.setKeyEvent=function(){function e(e){if(e.keyCode==32){e.preventDefault();if(isStand){isSpacePush=true;isJumping=true;isStand=false;createjs.Sound.play("jump")}}else if(e.keyCode==37){isLeftKeyPush=true}else if(e.keyCode==39){isRightKeyPush=true}}function t(e){a.gotoAndPlay("stand");isLeftKeyPush=false;isRightKeyPush=false}document.addEventListener("keydown",e,false);document.addEventListener("keyup",t,false)};n.tick=function(e){a.y+=vY;if(a.y<200&&isSpacePush){i++;u++}if(isJumping&&isSpacePush){a.y-=30;if(a.y<180){isSpacePush=false;vY=25;o=i}a.gotoAndPlay("jump");r=3}if(a.y+120>s){i--}if(isLeftKeyPush===true){a.x-=10;if(r!==0){a.gotoAndPlay("leftrun");r=0}}if(isRightKeyPush===true){a.x+=10;if(r!=1){a.gotoAndPlay("rightrun");r=1}}if(isSpacePush===false&&isLeftKeyPush===false&&isRightKeyPush===false){if(r!=2){a.gotoAndPlay("stand");r=2;isJumping=false;isStand=true}}};n.createAnimation=function(){var e={images:["./img/img_player.png"],frames:[[0,0,130,140],[130,0,130,140],[0,140,130,140],[130,142,130,140],[0,280,130,140],[130,280,130,140],[0,420,130,140],[130,420,130,140],[130,560,130,140],[130,560,130,140]],animations:{stand:{frames:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]},leftrun:{frames:[2,2,3,3]},rightrun:{frames:[4,4,5,5]},jump:{frames:[6,7]}}};var t=new createjs.SpriteSheet(e);return new createjs.Sprite(t)};e.Player=t})(window);
var STAGE_WIDTH=960;var STAGE_HEIGHT=540;var STAGEOUT_WIDTH=160;var isSpacePush;var isLeftKeyPush;var isRightKeyPush;var isJumping;var isStand;(function(e){function X(){if(!createjs.Sound.initializeDefaultPlugins()||createjs.Sound.BrowserDetect.isIOS||createjs.Sound.BrowserDetect.isAndroid)return $("#error").css("display","block");t=60*100;n=13;r=32;i=37;s=39;e.animation="";e.animate="";B="";loadingInterval=0;v=[];m=1;y=1;b=0;w=0;E=false;S=170;x=0;T=0;C=0;A=0;O=0;_=0;D=true;l=[];P=0;H=0;M="";isSpacePush=false;isLeftKeyPush=false;isRightKeyPush=false;isJumping=false;isStand=true;F="";j=99;$("#canvasShowArea").css("display","block");u=document.getElementById("gameCanvas");a=new createjs.Stage(u);W=new createjs.Text("Not found game loading","bold 24px Arial","#666666");W.maxWidth=1e3;W.textAlign="center";W.x=u.width/2;W.y=u.height-90;a.addChild(W);a.update();var o=[{id:"bgm",src:"./music/bgm.mp3|./music/bgm.ogg"},{id:"dead",src:"./music/dead.mp3|./music/dead.ogg"},{id:"jump",src:"./music/jump.mp3|./music/jump.ogg"},{id:"item",src:"./music/item_get.mp3|./music/item_get.ogg"},{id:"gameover",src:"./music/gameover.mp3|./music/gameover.ogg"},{id:"timeover",src:"./music/timeover.mp3|./music/timeover.ogg"},{src:"./img/back_1.jpg",id:"bg1"},{src:"./img/back_2.jpg",id:"bg2"},{src:"./img/back_3.jpg",id:"bg3"},{src:"./img/back_4.jpg",id:"bg4"},{src:"./img/back_5.jpg",id:"bg5"}];R=new createjs.LoadQueue;R.installPlugin(createjs.Sound);R.loadManifest(o);R.addEventListener("complete",K);R.addEventListener("progress",J);ut()}function V(){if(R!==null)R.close();createjs.Sound.stop()}function J(){if(R.progress<1){W.text="ロード中 "+(R.progress*100|0)+"%";a.update()}else if(R.progress==1){W.text="404 Not Found Game　=> Click Start"}}function K(e){N=new createjs.Bitmap("./img/img_count_03.png");N.x=u.width-163;N.y=u.height-135;c=new createjs.Text("0","bold 50px Arial","#ed6b6b");c.textAlign="right";scoreFloor=new createjs.Text("floor","bold 25px Arial","#ed6b6b");scoreFloor.textAlign="right";k=new createjs.Text("残り時間 60:","18px Arial","#FFFFFF");c.maxWidth=1e3;c.x=u.width-80;c.y=u.height-93;scoreFloor.x=u.width-20;scoreFloor.y=u.height-70;k.x=u.width-130;k.y=u.height-25;Q()}function Q(){a.update();if(L!==0){$("#canvasShowArea").css("background","url( ./img/title.jpg )")}if(D)u.onclick=G}function G(){$("#canvasShowArea").css("background","url(./img/back_1.jpg)");D=false;u.onclick=null;Y()}function Y(){a.removeAllChildren();a.addChild(N);c.text=0;a.addChildAt(c,1);a.addChildAt(scoreFloor,1);a.addChildAt(k,1);f=new Player;h=f.getAnimation();f.addChild(h);v[0]=new FloorGroup(476,1);o=v[0].getfloor();for(var e=0;e<o.length;e++){a.addChildAt(o[e],0)}createjs.Ticker.setFPS(30);a.addChildAt(f,8);createjs.Sound.stop();createjs.Sound.play("bgm",createjs.Sound.INTERRUPT_NONE,0,0,-1,.4);Z();et();createjs.Ticker.addEventListener("tick",nt)}function Z(){while(O<200){v[m]=new FloorGroup(646-(m+1)*170,m+1);o=v[m].getfloor();for(var e=0;e<o.length;e++){a.addChildAt(o[e],0)}O++;m++}}function et(){while(_<210){if(_%10===0){B=new Item(v[_].collection[0].children[0].y-255);l.push(B);H=B.getItemPosition();a.addChildAt(B)}_++}}function tt(e){if(e<10){return String("0"+e)}else{return String(e)}}function nt(e){C++;t-=3;k.text="残り時間 "+Number(Math.floor(t/100))+":"+tt(t%100);if(t<0){isStand=false;createjs.Sound.stop();createjs.Sound.play("timeover");ft(Number(c.text))}y=f.getWhere();if(y>-1)f.setFloorY(v[y].collection[0].floorImage.y);if(y>-1)g=v[y].isCollisionCheck(f,h.y);if(g){f.setVy(0);f.setCollision();if(y===b+1){rt();it(1)}b=y}else if(!g){f.setVy(5*(1/2^2));f.setNotCollision()}M=l[P].isCollisionCheckItem(h.x,h.y);if(M)q=true;if(M){createjs.Sound.play("item");t+=5*100;B.removeItem();I=new Sec(l[P].itemImage.x,l[P].itemImage.y);P+=1;a.addChildAt(I);setTimeout(function(){I.removeSec()},2e3)}if(u.height<l[P].itemImage.y){B.removeItem();P+=1}if(a.canvas.clientHeight-50<h.y){if(w===0){createjs.Sound.stop();isStand=false;createjs.Sound.play("gameover");w=1;setTimeout(ft(Number(c.text)),5e3)}}if(E){x+=17;$("#canvasShowArea").css("background-position","0px "+x+"px");h.y+=17;isStand=false;for(var n=0;n<v.length;n++){for(var r=0;r<v[n].collection.length;r++){v[n].collection[r].floorImage.y+=17}}for(var i in l){l[i].moveItemPositionY(17)}if(q){I.moveSecPositionY(17)}if(x==T){E=false}}a.update()}function rt(){E=true;T+=S}function it(e){c.text=Number(c.text)+Number(e);if(c.text==16){$("#canvasShowArea").css("background","url( ./img/back_2.jpg )")}else if(c.text==25){$("#canvasShowArea").css("background","url( ./img/back_3.jpg )")}else if(c.text==40){$("#canvasShowArea").css("background","url( ./img/back_4.jpg )")}else if(c.text==47){$("#canvasShowArea").css("background","url( ./img/back_5.jpg )")}}function st(e){if(!e||!document.cookie)return;var t=document.cookie.split("; ");for(var n=0;n<t.length;n++){var r=t[n].split("=");if(r[0]!=e)continue;return unescape(r[1])}}function ot(e,t,n,r,i,s){if(!e)return;var o=e+"="+escape(t);if(n){if(n==1)n=location.hostname;o+="; domain="+n}if(r){if(r==1)r=location.pathname;o+="; path="+r}if(i){var u=(new Date).getTime();i=new Date(u+60*60*24*1e3*i);i=i.toGMTString();o+="; expires="+i}if(s&&location.protocol=="https:")o+="; secure";document.cookie=o}function ut(){var e=st("sound");var t=$("#sound");var n=$("#switchSound");t.onclick=function(e){if(t.attr("data-status")==="on"){ot("sound","off",1,"/",1);createjs.Sound.setMute(true);t.attr("data-status","off");n.checked=false;return false}ot("sound","on",1,"/",1);createjs.Sound.setMute(false);t.attr("data-status","on");n.checked=true;return false};if(e===null||e==="on"){createjs.Sound.setMute(false);t.attr("data-status","on");n.checked=true}else if(e==="off"){createjs.Sound.setMute(true);t.attr("data-status","off");n.checked=false}}function ft(t){createjs.Ticker.removeEventListener("tick",nt);for(var n=0;n<o.length;n++){o[n].removeAllChildren()}B.removeAllChildren();a.removeAllChildren();var r=$("#overlay");var i=$("#shareScoreOverlay");var s=$("#shareScoreClose");var u=$("#nickNameInput");var f=$("#scoreInput");var l=$("#sendScoreButton");var c=$("#twitterShareButton");var h=$("#facebookShareButton");var p=$("#innerRanking");var d=$("#sendScoreForm");var v=$("#scoreText");var m=$("#rankIn");var g=$("#rankInScore");r.css("display","block");i.css("display","block");d.css("display","block");v.css("display","block");p.css("display","none");f.val(t);if(at)return;at=true;r.click(function(e){r.css("display","none");i.css("display","none");L++;X()});s.click(function(e){r.css("display","none");i.css("display","none");L++;X()});l.click(function(t){var n="";try{if(!e.localStorage)throw 0;var r=e.localStorage.getItem("__pcmnz");r=JSON.parse(r);n=r.userId}catch(i){}e._picomon_savedScore=function(e){p.css("display","block");d.css("display","none");v.css("display","none");if(e.rank!==0&&e.rank<=10){m.css("display","block");g.text(e.rank+"位")}else{m.css("display","none")}for(var t in e.ranking){try{var n=JSON.parse(e.ranking[t]);if(+t+1>3)document.getElementById("innnerRankingNo_"+t).innerHTML=+t+1;document.getElementById("innnerRankingName_"+t).innerHTML=n.nickname;document.getElementById("innnerRankingScore_"+t).innerHTML=n.score}catch(r){continue}}};var s=function(e){return};var o=document.createElement("script");o.src="http://picomon.jp/404score.js?data="+Base64.encodeURI(JSON.stringify({callback:" _picomon_savedScore",type:"escape",score:document.getElementById("scoreInput").value,nickname:encodeURIComponent(u.val()),pcu:n}));var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a);o.onload=function(){a.parentNode.removeChild(o)}});c.click(function(t){var n=encodeURIComponent("ピコもん 404ゲームで"+document.getElementById("scoreInput").value+"階まで登った！");e.open("https://twitter.com/intent/tweet?hashtags=picomon&original_referer=http%3A%2F%2F404.picomon.jp%2F&text="+n+"&tw_p=tweetbutton&url=http%3A%2F%2F404.picomon.jp%2F&related=picomon_jp",null,"width=400,height=300")});h.click(function(t){var n=function(){e.open("https://www.facebook.com/sharer.php?src=bm&v=4&i=1374645413&u="+encodeURIComponent(location.href)+"&t="+encodeURIComponent("ピコもん 404ゲームで"+document.getElementById("scoreInput").value+"階まで登った！"),"sharer","toolbar=0,status=0,resizable=1,width=626,height=436")};if(/Firefox/.test(navigator.userAgent)){setTimeout(n,0)}else{n()}})}var t;var n;var r;var i;var s;var o;var u;var a;var f;var l;var c;var h;var p;var d;var v;var m;var g;var y;var b;var w;var E;var S;var x;var T;var N;var C;var k;var L=0;var A;var O;var M;var _;var D;var P;var H;var B;var j;var F;var I;var q;var R;var U;var z;var W;var at=false;e.onload=X})(window);