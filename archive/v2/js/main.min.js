var STAGE_WIDTH=960,STAGE_HEIGHT=540,STAGEOUT_WIDTH=160,isSpacePush,isLeftKeyPush,isRightKeyPush,isJumping,isStand;!function(e){function t(){if(!createjs.Sound.initializeDefaultPlugins()||createjs.Sound.BrowserDetect.isIOS||createjs.Sound.BrowserDetect.isAndroid)return $("#error").css("display","block");y=6e3,S=13,b=32,w=37,j=39,e.animation="",e.animate="",X="",loadingInterval=0,E=[],N=1,P=1,R=0,L=0,G=!1,H=170,M=0,U=0,O=0,J=0,K=0,z=0,V=!0,C=[],Q=0,q=0,Y="",isSpacePush=!1,isLeftKeyPush=!1,isRightKeyPush=!1,isJumping=!1,isStand=!0,et="",Z=99,$("#canvasShowArea").css("display","block"),x=document.getElementById("gameCanvas"),I=new createjs.Stage(x),it=new createjs.Text("Not found game loading","bold 24px Arial","#666666"),it.maxWidth=1e3,it.textAlign="center",it.x=x.width/2,it.y=x.height-90,I.addChild(it),I.update();var t=[{id:"bgm",src:"./music/bgm.mp3|./music/bgm.ogg"},{id:"dead",src:"./music/dead.mp3|./music/dead.ogg"},{id:"jump",src:"./music/jump.mp3|./music/jump.ogg"},{id:"item",src:"./music/item_get.mp3|./music/item_get.ogg"},{id:"gameover",src:"./music/gameover.mp3|./music/gameover.ogg"},{id:"timeover",src:"./music/timeover.mp3|./music/timeover.ogg"},{src:"./img/back_1.jpg",id:"bg1"},{src:"./img/back_2.jpg",id:"bg2"},{src:"./img/back_3.jpg",id:"bg3"},{src:"./img/back_4.jpg",id:"bg4"},{src:"./img/back_5.jpg",id:"bg5"},{src:"./img/img_player.png",id:"player"}];nt=new createjs.LoadQueue,nt.installPlugin(createjs.Sound),nt.loadManifest(t),nt.addEventListener("complete",n),nt.addEventListener("progress",o),h()}function o(){nt.progress<1?(it.text="ロード中 "+(100*nt.progress|0)+"%",I.update()):1==nt.progress&&(it.text="404 Not Found Game　=> Click Start")}function n(){D=new createjs.Bitmap("./img/img_count_03.png"),D.x=x.width-163,D.y=x.height-135,T=new createjs.Text("0","bold 50px Arial","#ed6b6b"),T.textAlign="right",scoreFloor=new createjs.Text("floor","bold 25px Arial","#ed6b6b"),scoreFloor.textAlign="right",W=new createjs.Text("残り時間 60:","18px Arial","#FFFFFF"),T.maxWidth=1e3,T.x=x.width-80,T.y=x.height-93,scoreFloor.x=x.width-20,scoreFloor.y=x.height-70,W.x=x.width-130,W.y=x.height-25,i()}function i(){I.update(),0!==at&&$("#canvasShowArea").css("background","url( ./img/title.jpg )"),V&&(x.onclick=a)}function a(){$("#canvasShowArea").css("background","url(./img/back_1.jpg)"),V=!1,x.onclick=null,c()}function c(){I.removeAllChildren(),I.addChild(D),T.text=0,I.addChildAt(T,1),I.addChildAt(scoreFloor,1),I.addChildAt(W,1),A=new Player,F=A.getAnimation(),A.addChild(F),E[0]=new FloorGroup(476,1),_=E[0].getfloor();for(var e=0;e<_.length;e++)I.addChildAt(_[e],0);createjs.Ticker.setFPS(30),I.addChildAt(A,8),createjs.Sound.stop(),createjs.Sound.play("bgm",createjs.Sound.INTERRUPT_NONE,0,0,-1,.4),r(),s(),createjs.Ticker.addEventListener("tick",l)}function r(){for(;500>K;){E[N]=new FloorGroup(646-170*(N+1),N+1),_=E[N].getfloor();for(var e=0;e<_.length;e++)I.addChildAt(_[e],0);K++,N++}}function s(){for(;510>z;)z%10===0&&(X=new Item(E[z].collection[0].children[0].y-255),C.push(X),q=X.getItemPosition(),I.addChildAt(X)),z++}function d(e){return String(10>e?"0"+e:e)}function l(){if(O++,y-=3,W.text="残り時間 "+Number(Math.floor(y/100))+":"+d(y%100),0>y&&(isStand=!1,createjs.Sound.stop(),createjs.Sound.play("timeover"),f(Number(T.text))),P=A.getWhere(),P>-1&&A.setFloorY(E[P].collection[0].floorImage.y),P>-1&&(B=E[P].isCollisionCheck(A,F.y)),B?(A.setVy(0),A.setCollision(),P===R+1&&(m(),u(1)),R=P):B||(A.setVy(10),A.setNotCollision()),Y=C[Q].isCollisionCheckItem(F.x,F.y),Y&&(ot=!0),Y&&(createjs.Sound.play("item"),y+=500,X.removeItem(),tt=new Sec(C[Q].itemImage.x,C[Q].itemImage.y),Q+=1,I.addChildAt(tt),setTimeout(function(){tt.removeSec()},2e3)),x.height<C[Q].itemImage.y&&(X.removeItem(),Q+=1),I.canvas.clientHeight-50<F.y&&0===L&&(createjs.Sound.stop(),isStand=!1,createjs.Sound.play("gameover"),L=1,setTimeout(f(Number(T.text)),5e3)),G){M+=17,$("#canvasShowArea").css("background-position","0px "+M+"px"),F.y+=17,isStand=!1;for(var e=0;e<E.length;e++)for(var t=0;t<E[e].collection.length;t++)E[e].collection[t].floorImage.y+=17;for(var o in C)C[o].moveItemPositionY(17);ot&&tt.moveSecPositionY(17),M==U&&(G=!1)}I.update()}function m(){G=!0,U+=H}function u(e){T.text=Number(T.text)+Number(e),16==T.text?$("#canvasShowArea").css("background","url( ./img/back_2.jpg )"):25==T.text?$("#canvasShowArea").css("background","url( ./img/back_3.jpg )"):40==T.text?$("#canvasShowArea").css("background","url( ./img/back_4.jpg )"):47==T.text&&$("#canvasShowArea").css("background","url( ./img/back_5.jpg )")}function g(e){if(e&&document.cookie)for(var t=document.cookie.split("; "),o=0;o<t.length;o++){var n=t[o].split("=");if(n[0]==e)return unescape(n[1])}}function p(e,t,o,n,i,a){if(e){var c=e+"="+escape(t);if(o&&(1==o&&(o=location.hostname),c+="; domain="+o),n&&(1==n&&(n=location.pathname),c+="; path="+n),i){var r=(new Date).getTime();i=new Date(r+864e5*i),i=i.toGMTString(),c+="; expires="+i}a&&"https:"==location.protocol&&(c+="; secure"),document.cookie=c}}function h(){var e=g("sound"),t=$("#sound"),o=$("#switchSound");o.on("change",function(){return o.is(":checked")?(p("sound","on",1,"/",1),createjs.Sound.setMute(!1),t.attr("data-status","on"),!1):(p("sound","off",1,"/",1),createjs.Sound.setMute(!0),t.attr("data-status","off"),!1)}),"off"===e&&o.click()}function f(o){createjs.Ticker.removeEventListener("tick",l);for(var n=0;n<_.length;n++)_[n].removeAllChildren();X.removeAllChildren(),I.removeAllChildren();var i=$("#overlay"),a=$("#shareScoreOverlay"),c=$("#shareScoreClose"),r=$("#nickNameInput"),s=$("#scoreInput"),d=$("#sendScoreButton"),m=$("#twitterShareButton"),u=$("#facebookShareButton"),g=$("#innerRanking"),p=$("#sendScoreForm"),h=$("#scoreText"),f=$("#rankIn"),v=$("#rankInScore");i.css("display","block"),a.css("display","block"),p.css("display","block"),h.css("display","block"),g.css("display","none"),s.val(o),ct||(ct=!0,i.click(function(){i.css("display","none"),a.css("display","none"),at++,t()}),c.click(function(){i.css("display","none"),a.css("display","none"),at++,t()}),d.click(function(){e._picomon_savedScore=function(e){g.css("display","block"),p.css("display","none"),h.css("display","none"),0!==e.rank&&e.rank<=10?(f.css("display","block"),v.text(e.rank+"位")):f.css("display","none");for(var t in e.ranking)try{var o=JSON.parse(e.ranking[t]);+t+1>3&&(document.getElementById("innnerRankingNo_"+t).innerHTML=+t+1),document.getElementById("innnerRankingName_"+t).innerHTML=o.nickname,document.getElementById("innnerRankingScore_"+t).innerHTML=o.score}catch(n){continue}};var t="function"==typeof e.__404_picomon_solt__?__404_picomon_solt__():"",o=document.createElement("script"),n=parseInt(document.getElementById("scoreInput").value,10);o.src="https://www.picomon.jp/game/set_score?data="+Base64.encodeURI(t+Base64.encodeURI(JSON.stringify({callback:"_picomon_savedScore",type:"escape404",score:0===n?1:n,nickname:encodeURIComponent(r.val())})));var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(o,i),o.onload=function(){i.parentNode.removeChild(o)}}),m.click(function(){var t=encodeURIComponent("ピコもん 404ゲームで"+document.getElementById("scoreInput").value+"階まで登った！");e.open("https://twitter.com/intent/tweet?hashtags=picomon&original_referer=http%3A%2F%2F404.picomon.jp%2F&text="+t+"&tw_p=tweetbutton&url=http%3A%2F%2F404.picomon.jp%2F&related=picomon_jp",null,"width=400,height=300")}),u.click(function(){var t=function(){e.open("https://www.facebook.com/sharer.php?src=bm&v=4&i=1374645413&u="+encodeURIComponent(location.href)+"&t="+encodeURIComponent("ピコもん 404ゲームで"+document.getElementById("scoreInput").value+"階まで登った！"),"sharer","toolbar=0,status=0,resizable=1,width=626,height=436")};/Firefox/.test(navigator.userAgent)?setTimeout(t,0):t()}))}var v=document.createElement("script");v.src="https://www.picomon.jp/game/get_solt.js";var k=document.getElementsByTagName("script")[0];k.parentNode.insertBefore(v,k);var y,S,b,w,j,_,x,I,A,C,T,F,E,N,B,P,R,L,G,H,M,U,D,O,W,J,K,Y,z,V,Q,q,X,Z,et,tt,ot,nt,it,at=0,ct=!1;e.onload=t}(window);